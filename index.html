<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8" />
<title>Doln√≠ Lhota Run</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  :root {
    --primary: #2779e2;
    --accent: #ffac33;
    --bg: #f7fafc;
    --sidebar-bg: linear-gradient(90deg, #2779e2 0%, #48c3cb 50%, #1da1f2 100%);
    --card-bg: #fff;
    --text: #212529;
    --active-bg: #fff;
    --active-color: #2779e2;
    --inactive-color: #8b96ab;
  }
  [data-theme="dark"] {
    --primary: #8ab8fa;
    --accent: #ffa338;
    --bg: #181c24;
    --sidebar-bg: linear-gradient(90deg, #22243c 80%, #2779e2 150%);
    --card-bg: #24283b;
    --text: #f3f7fa;
    --active-bg: #fff;
    --active-color: #2779e2;
    --inactive-color: #607088;
  }
  body {
    margin: 0;
    padding: 0;
    font-family: 'Segoe UI', 'Montserrat', Arial, sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    transition: background .2s, color .2s;
  }
  #sidebar {
    position: fixed;
    top: 0; left: 0; right: 0;
    height: 60px;
    background: var(--sidebar-bg);
    display: flex;
    align-items: center;
    padding: 0 20px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    z-index: 1000;
    overflow-x: auto;
    scrollbar-width: none;
    transition: top 0.3s ease;
  }
  #sidebar::-webkit-scrollbar {
    display: none;
  }
  .sidebar-logo {
    flex: 0 0 auto;
    font-size: 1.4em;
    font-weight: 700;
    margin-right: 30px;
    color: #fff;
    white-space: nowrap;
  }
  .sidebar-btn {
    flex: 0 0 auto;
    margin: 0 8px;
    padding: 10px 20px;
    border-radius: 12px;
    font-size: 1em;
    display: flex;
    align-items: center;
    gap: 6px;
    cursor: pointer;
    background: none;
    border: none;
    color: var(--inactive-color);
    transition: background-color 0.3s, color 0.3s;
  }
  .sidebar-btn.active {
    background: var(--active-bg);
    color: var(--active-color);
    font-weight: 600;
    box-shadow: 0 2px 8px rgba(39, 121, 226, 0.4);
  }
  .sidebar-btn:hover:not(.active) {
    background: #fff3;
    color: var(--primary);
  }
  .theme-switch {
    margin-left: auto;
    background: transparent;
    color: #fff;
    font-size: 1.2em;
    cursor: pointer;
    border: none;
  }
  main {
    margin-top: 60px;
    padding: 20px;
    max-width: 960px;
    margin-left: auto;
    margin-right: auto;
  }
  .card {
    display: none;
  }
  .card.active {
    display: block;
  }
</style>
</head>
<body data-theme="light">

<header id="sidebar">
  <div class="sidebar-logo">üèÉ Doln√≠ Lhota Run</div>
  <button class="sidebar-btn active" id="menu-hlavni">Hlavn√≠ str√°nka</button>
  <button class="sidebar-btn" id="menu-moje">Moje bƒõhy</button>
  <button class="sidebar-btn" id="menu-tym">T√Ωm</button>
  <button class="sidebar-btn" id="menu-vsichni">V≈°ichni bƒõ≈æci</button>
  <button class="sidebar-btn" id="menu-stats">üìä Statistiky</button>
  <button class="sidebar-btn" id="logoutBtn" style="display:none;">Odhl√°sit</button>
  <button class="theme-switch" id="themeToggleBtn" title="P≈ôepnout tmav√Ω/svƒõtl√Ω re≈æim">üåô</button>
</header>

<main>
<section id="page-hlavni" class="card active">
    <h2>V√≠tej v bƒõ≈æeck√© v√Ωzvƒõ Doln√≠ Lhoty!</h2>
    <p>Sleduj sv√© bƒõhy, p≈ôidej nov√©, zapoj se do t√Ωmu a porovn√°vej se s ostatn√≠mi.</p>
  </section>

  <section id="page-moje" class="card">
    <h2>Moje bƒõhy</h2>
    <label for="input-km">Kilometry (km):</label>
    <input type="number" id="input-km" step="0.01" min="0" placeholder="Nap≈ô. 5.3" />
    <label for="input-min">ƒåas (minuty):</label>
    <input type="number" id="input-min" step="1" min="1" placeholder="Nap≈ô. 30" />
    <label for="input-pace">Pr≈Ømƒõrn√© tempo (min/km):</label>
    <input type="text" id="input-pace" disabled placeholder="0.00" />
    <button class="primary-btn" id="btnAddRun">P≈ôidat bƒõh</button>
    <ul id="myRunsList" class="run-list"></ul>
  </section>

  <section id="page-tym" class="card">
    <h2>T√Ωm</h2>
    <label for="select-team">Vyber t√Ωm</label>
    <select id="select-team"></select>
    <button class="primary-btn" id="btnJoinTeam">P≈ôidat se do t√Ωmu</button>
    <h3>ƒålenov√© t√Ωmu</h3>
    <ul id="teamMembersList" class="run-list"></ul>
    <label for="input-new-team">Vytvo≈ôit nov√Ω t√Ωm</label>
    <input type="text" id="input-new-team" placeholder="N√°zev t√Ωmu" />
    <button class="primary-btn" id="btnCreateTeam">Vytvo≈ôit t√Ωm</button>
  </section>

  <section id="page-vsichni" class="card">
    <h2>V≈°ichni bƒõ≈æci</h2>
    <table>
      <thead>
        <tr>
          <th>#</th><th>Jm√©no</th><th>Celkem km</th><th>Celkem min</th><th>Pr≈Ømƒõrn√© tempo</th><th>T√Ωm</th>
        </tr>
      </thead>
      <tbody id="runnersTableBody"></tbody>
    </table>
  </section>

  <section id="page-stats" class="card">
    <h2>Statistiky bƒõh≈Ø</h2>
    <div style="margin-bottom:12px;">
      <button id="btn-week" class="active-filter">Posledn√≠ t√Ωden</button>
      <button id="btn-month">Posledn√≠ mƒõs√≠c</button>
    </div>
    <div id="stats-summary"></div>
    <canvas id="runsChart" width="400" height="250"></canvas>
  </section>
</main>

<script>
  const runs = [];
  const runners = {
    'Alena': { km: 15, min: 90 },
    'Karel': { km: 20, min: 100 }
  };
  const teams = {
    'Brouci': ['Alena'],
    'Lesn√≠ bƒõ≈æci': ['Karel']
  };
  let currentTeam = null;

  const sections = {
    hlavni: document.getElementById('page-hlavni'),
    moje: document.getElementById('page-moje'),
    tym: document.getElementById('page-tym'),
    vsichni: document.getElementById('page-vsichni'),
    stats: document.getElementById('page-stats')
  };

  const buttons = {
    hlavni: document.getElementById('menu-hlavni'),
    moje: document.getElementById('menu-moje'),
    tym: document.getElementById('menu-tym'),
    vsichni: document.getElementById('menu-vsichni'),
    stats: document.getElementById('menu-stats'),
    logout: document.getElementById('logoutBtn'),
    themeToggle: document.getElementById('themeToggleBtn')
  };

  function showSection(name) {
    Object.values(sections).forEach(s => s.classList.remove('active'));
    if (sections[name]) {
      sections[name].classList.add('active');
    }
    Object.values(buttons).forEach(b => b.classList.remove('active'));
    if (buttons[name]) {
      buttons[name].classList.add('active');
    }
    if (name === 'moje') renderMyRuns();
    if (name === 'tym') {
      renderTeamSelect();
      renderTeamMembers();
    }
    if (name === 'vsichni') renderRunnersTable();
    if (name === 'stats') {
      setFilter('week');
    }
  }

  // Schov√°v√°n√≠ horn√≠ho panelu p≈ôi scrollu
  let lastScrollTop = 0;
  const header = document.getElementById('sidebar');
  window.addEventListener('scroll', () => {
    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
    if (scrollTop > lastScrollTop && scrollTop > 100) {
      header.style.top = '-60px';
    } else {
      header.style.top = '0';
    }
    lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
  });
</script>
<script>
  // V√Ωpoƒçet a zobrazen√≠ pr≈Ømƒõrn√©ho tempa
  function updatePace() {
    const km = parseFloat(document.getElementById('input-km').value);
    const min = parseInt(document.getElementById('input-min').value);
    if (km > 0 && min > 0) {
      document.getElementById('input-pace').value = (min / km).toFixed(2);
    } else {
      document.getElementById('input-pace').value = '';
    }
  }
  document.getElementById('input-km').addEventListener('input', updatePace);
  document.getElementById('input-min').addEventListener('input', updatePace);

  let editingRunIndex = -1;

  document.getElementById('btnAddRun').addEventListener('click', () => {
    const km = parseFloat(document.getElementById('input-km').value);
    const min = parseInt(document.getElementById('input-min').value);
    if (!km || !min || km <= 0 || min <= 0) {
      alert('Pros√≠m, zadej platn√© km i minuty.');
      return;
    }
    const pace = min / km;

    if (editingRunIndex >= 0) {
      runs[editingRunIndex] = { km, min, pace };
      editingRunIndex = -1;
      document.getElementById('btnAddRun').textContent = 'P≈ôidat bƒõh';
    } else {
      runs.push({ km, min, pace });
    }

    renderMyRuns();

    if (!runners['Ty']) {
      runners['Ty'] = { km: 0, min: 0 };
    }
    runners['Ty'].km += km;
    runners['Ty'].min += min;

    renderRunnersTable();

    document.getElementById('input-km').value = '';
    document.getElementById('input-min').value = '';
    document.getElementById('input-pace').value = '';
  });

  function renderMyRuns() {
    const ul = document.getElementById('myRunsList');
    ul.innerHTML = '';
    runs.forEach((run, i) => {
      const li = document.createElement('li');
      li.style.marginBottom = '12px';
      li.innerHTML = `
        <b>Bƒõh ${i + 1}:</b> ${run.km.toFixed(2)} km, ${run.min} min, tempo ${run.pace.toFixed(2)} min/km
        <button onclick="editRun(${i})" style="margin-left: 10px;">Upravit</button>
        <button onclick="deleteRun(${i})" style="margin-left: 6px; color: red;">Smazat</button>
      `;
      ul.appendChild(li);
    });
  }

  function editRun(index) {
    const run = runs[index];
    document.getElementById('input-km').value = run.km;
    document.getElementById('input-min').value = run.min;
    updatePace();
    editingRunIndex = index;
    document.getElementById('btnAddRun').textContent = 'Ulo≈æit zmƒõny';
  }

  function deleteRun(index) {
    if (confirm('Opravdu chcete smazat tento bƒõh?')) {
      runs.splice(index, 1);
      renderMyRuns();
    }
  }

  // T√Ωm
  function renderTeamSelect() {
    const select = document.getElementById('select-team');
    select.innerHTML = '';
    for (const teamName in teams) {
      const option = document.createElement('option');
      option.value = teamName;
      option.textContent = teamName;
      select.appendChild(option);
    }
  }

  document.getElementById('btnJoinTeam').addEventListener('click', () => {
    const select = document.getElementById('select-team');
    const chosenTeam = select.value;
    if (!chosenTeam) return alert('Vyber t√Ωm.');

    for (const teamName in teams) {
      const idx = teams[teamName].indexOf('Ty');
      if (idx !== -1 && teamName !== chosenTeam) {
        teams[teamName].splice(idx, 1);
      }
    }

    if (!teams[chosenTeam].includes('Ty')) {
      teams[chosenTeam].push('Ty');
    }

    currentTeam = chosenTeam;
    renderTeamMembers();
    alert(`P≈ôid√°n do t√Ωmu ${chosenTeam}`);
  });

  function renderTeamMembers() {
    const ul = document.getElementById('teamMembersList');
    ul.innerHTML = '';
    if (!currentTeam || !teams[currentTeam] || teams[currentTeam].length === 0) {
      ul.textContent = 'Nejsi zat√≠m v ≈æ√°dn√©m t√Ωmu.';
      return;
    }
    teams[currentTeam].forEach(member => {
      const li = document.createElement('li');
      li.textContent = member;
      ul.appendChild(li);
    });
  }

  document.getElementById('btnCreateTeam').addEventListener('click', () => {
    const input = document.getElementById('input-new-team');
    const teamName = input.value.trim();
    if (!teamName) {
      alert('Zadej n√°zev t√Ωmu.');
      return;
    }
    if (teams[teamName]) {
      alert('T√Ωm s t√≠mto n√°zvem u≈æ existuje.');
      return;
    }
    teams[teamName] = [];
    input.value = '';
    alert(`T√Ωm "${teamName}" byl vytvo≈ôen.`);
    renderTeamSelect();
  });

  // Tabulka bƒõ≈æc≈Ø
  function renderRunnersTable() {
    const tbody = document.getElementById('runnersTableBody');
    tbody.innerHTML = '';
    const sorted = Object.entries(runners).sort((a,b) => b[1].km - a[1].km);
    sorted.forEach(([name, stats], index) => {
      let teamName = '-';
      for (const tName in teams) {
        if (teams[tName].includes(name)) {
          teamName = tName;
          break;
        }
      }
      const pace = (stats.min / stats.km).toFixed(2);
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${index + 1}</td>
        <td>${name}</td>
        <td>${stats.km.toFixed(2)}</td>
        <td>${stats.min}</td>
        <td>${pace}</td>
        <td>${teamName}</td>
      `;
      tbody.appendChild(tr);
    });
  }

  // Statistiky a graf
  let currentFilter = 'week';
  let runsChart;

  document.getElementById('btn-week').addEventListener('click', () => setFilter('week'));
  document.getElementById('btn-month').addEventListener('click', () => setFilter('month'));

  function setFilter(period) {
    currentFilter = period;
    document.getElementById('btn-week').classList.toggle('active-filter', period === 'week');
    document.getElementById('btn-month').classList.toggle('active-filter', period === 'month');
    updateStats();
    drawChart();
  }

  function updateStats() {
    let filteredRuns = currentFilter === 'week' ? runs.slice(-7) : runs.slice(-30);
    const totalKm = filteredRuns.reduce((sum, run) => sum + run.km, 0);
    const totalMin = filteredRuns.reduce((sum, run) => sum + run.min, 0);
    const avgPace = totalKm ? (totalMin / totalKm).toFixed(2) : '0.00';

    document.getElementById('stats-summary').innerHTML = `
      <p>Celkem km: <b>${totalKm.toFixed(2)}</b></p>
      <p>Celkem minut: <b>${totalMin}</b></p>
      <p>Pr≈Ømƒõrn√© tempo: <b>${avgPace} min/km</b></p>
    `;
  }

  function drawChart() {
    const ctx = document.getElementById('runsChart').getContext('2d');
    if (runsChart) runsChart.destroy();
    let filteredRuns = currentFilter === 'week' ? runs.slice(-7) : runs.slice(-30);
    const labels = filteredRuns.map((_, i) => `Bƒõh ${i + 1}`);
    const dataKm = filteredRuns.map(run => run.km);

    runsChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: labels,
        datasets: [{
          label: 'Vzd√°lenost (km)',
          data: dataKm,
          fill: false,
          borderColor: 'rgb(39, 121, 226)',
          tension: 0.1
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: { beginAtZero: true }
        }
      }
    });
  }

  // P≈ôep√≠n√°n√≠ str√°nek menu
  buttons.hlavni.onclick = () => showSection('hlavni');
  buttons.moje.onclick = () => showSection('moje');
  buttons.tym.onclick = () => showSection('tym');
  buttons.vsichni.onclick = () => showSection('vsichni');
  buttons.stats.onclick = () => showSection('stats');
  buttons.logout.onclick = () => {
    alert('Odhl√°≈°en (demo)');
    // Tady by ≈°lo p≈ôidat skuteƒçn√© odhl√°≈°en√≠
  };
  buttons.themeToggle.onclick = () => {
    const html = document.documentElement;
    const isDark = html.getAttribute('data-theme') === 'dark';
    if (isDark) {
      html.setAttribute('data-theme', 'light');
      localStorage.setItem('theme', 'light');
      buttons.themeToggle.textContent = 'üåô';
    } else {
      html.setAttribute('data-theme', 'dark');
      localStorage.setItem('theme', 'dark');
      buttons.themeToggle.textContent = '‚òÄÔ∏è';
    }
  };

  // Naƒçten√≠ ulo≈æen√©ho re≈æimu a start
  window.onload = () => {
    const savedTheme = localStorage.getItem('theme') || 'light';
    document.documentElement.setAttribute('data-theme', savedTheme);
    buttons.themeToggle.textContent = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';

    showSection('hlavni');
  };
              </script>
